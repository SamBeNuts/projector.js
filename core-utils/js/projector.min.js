/*
 * projector.js v1.0.0
 *
 * Copyright (C) 2019 Samuel Lager
 */

!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.Projector=t()}(this,function(){"use strict";let e,t="1.0.0",o={body:document.querySelector("body"),slides:document.querySelector(".slides")},s={autoplay:!1,autoplayTiming:4e3,animations:!0,controls:!0,cursorVisible:"auto",cursorVisibleTiming:4e3,defaultBackground:"none",defaultBackgroundOptions:{},defaultTransition:"none",defaultTransitionOptions:{},heightSlide:1080,history:!1,keyboard:!0,loop:!1,mouseWheel:!0,progress:!0,resizeSlides:!0,selectionEnabled:!0,selectionLayout:!1,speakerWindow:!1,widthSlide:1920},n={autoplayId:null,cursorVisibleTimingId:null,initialized:!1,loaded:!1,nbSlide:0,scale:1,slideActive:-1,userAgent:null},r={en:{pause:'<b>PAUSE</b><br>Press <span class="keybind_white">P</span> to continue',end:'<b>END</b><br>Press <span class="keybind_white">P</span> to restrart',stop_presenting:"STOP PRESENTING",options_title:"Options",fullscreen_option:"Fullscreen",fullscreen_option_info:"Shortcut : F"},fr:{pause:'<b>PAUSE</b><br>Presser <span class="keybind_white">P</span> pour continuer',end:'<b>END</b><br>Presser <span class="keybind_white">R</span> pour revoir',stop_presenting:"ARRÊTER LA PRÉSENTATION",options_title:"Options",fullscreen_option:"Plein écran",resize_option:"Adapter à l'écran",resize_option_info:"Adapte la taille de la diapositive à l'écran tout en conservant le ratio",loop_option:"Lire en boucle",loop_option_info:"Après la dernière diapositive reviens à la première",keyboard_option:"Contrôler avec le clavier",keyboard_option_info:"Voir les raccourcis pour plus de détails",autoplay_option:"Lecture automatique",autoplay_option_info:"Passe à la diapositive suivante automatiquement (n'active pas les animations)",mousewheel_option:"Contrôler avec la molette",mousewheel_option_info:"Permet de contrôler le diaporama avec la molette de la souris",cursor_option:"Cacher le curseur",cursor_option_info:"Désactive le curseur de la souris",selection_option:"Autoriser la sélection",selection_option_info:"Désactive le clic gauche de la souris pour passer à la diapositive suivante",progress_option:"Barre de progression",controls_option:"Afficher les contrôles",shortcuts_title:"Raccourcis",shortcut_fullscreen:"<b>F</b> : Plein écran",shortcut_menu:"<b>M</b> : Menu",shortcut_previous:"<b>Flèche gauche/bas</b> : Diapositive précédente",shortcut_next:"<b>Espace</b>, <b>Flèche droite/haut</b>, <b>Clique gauche</b> : Dispositive suivante",shortcut_pause:"<b>P</b> : Pause",shortcut_restart:"<b>R</b> : Recommencer"}};function i(){"true"===o.slides.dataset.resize?(n.scale=Math.min(window.innerHeight/o.slides.dataset.height,window.innerWidth/o.slides.dataset.width),o.slides.style.transform="translate(-50%, -50%) scale("+n.scale+")"):(n.scale=1,o.slides.style.transform="translate(-50%, -50%)")}function l(e,t,s,n,r,i){let l=document.createElement(t);l.classList.add(s);for(let e in n)l.dataset[e]=n[e];return l.innerHTML=r,i?e.insertBefore(l,o.slides):e.appendChild(l),l}function c(e,t,s,n){let r='<div class="checkbox';n&&(r+=" checked"),r+='" id="'+e+'">    <div onclick="'+t+'"></div>    <span data-trad="'+e+'_option"></span></div>',s&&(r+='<p class="info" data-trad="'+e+'_option_info"></p>'),l(o.menu.children[1].children[0],"div","option",null,r,!1)}function a(){o.upperLayer.dataset.cursor="true",o.upperLayer.dataset.selection=s.selectionEnabled,clearTimeout(n.cursorVisibleTimingId),n.cursorVisibleTimingId=setTimeout(function(){o.upperLayer.dataset.cursor="false",o.upperLayer.dataset.selection="false"},s.cursorVisibleTiming)}function d(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen()}function u(){}function p(e,t){e.dataset[t]=(!function(e){if("string"==typeof e){if("null"===e)return null;if("true"===e)return!0;if("false"===e)return!1;if(e.match(/^-?\d*\.\d*$/))return parseFloat(e);if(e.match(/^-?\d*$/))return parseInt(e)}return e}(e.dataset[t])).toString()}function m(e,t,o){e.parentElement.classList.toggle("checked"),null!==t&&t.apply(window,o)}return e={start:function(h){n.initialized||(n.initialized=!0,console.info("v"+t),function(e,t){for(let o in t)e[o]=t[o]}(s,h),n.userAgent=navigator.userAgent,n.nbSlide=o.slides.children.length,o.loading=l(o.body,"div","loading",null,'<div class="lds-ring"><div></div><div></div><div></div><div></div></div>',!0),o.end=l(o.body,"div","end",{end:!1},'<p data-trad="end"></p>',!0),o.backgrounds=l(o.body,"div","backgrounds",null,"",!0),o.upperLayer=l(o.body,"div","upper_layer",{cursor:s.cursorVisible&&"auto"!==s.cursorVisible,selection:s.selectionEnabled},"",!1),o.progress=l(o.body,"div","progress",{progress:s.progress},"",!1),o.controls=l(o.body,"div","controls",{controls:s.controls},'<img src="core-utils/media/projector_controls_icon.png" onclick="previousSlide()"><img src="core-utils/media/projector_controls_icon.png" onclick="nextSlide()">',!1),o.pause=l(o.body,"div","pause",{pause:!1},'<p data-trad="pause"></p>',!1),o.menu=l(o.body,"div","menu",{menu:!0},'<div class="top_logo">    <a href="https://www.impart.com"><img src="core-utils/media/logo_negative.png"></a></div><div class="content">    <div class="content_part">        <p class="title" data-trad="options_title"></p>    </div>    <div class="content_part">        <p class="title" data-trad="shortcuts_title"></p>        <p class="shortcut" data-trad="shortcut_fullscreen"></p>        <p class="shortcut" data-trad="shortcut_menu"></p>        <p class="shortcut" data-trad="shortcut_previous"></p>        <p class="shortcut" data-trad="shortcut_next"></p>        <p class="shortcut" data-trad="shortcut_pause"></p>        <p class="shortcut" data-trad="shortcut_restart"></p>    </div></div><div class="bottom_stop" onclick="window.close();">    <p data-trad="stop_presenting"></p></div>',!1),c("fullscreen","Projector.checkboxClick(this, Projector.toggleFullscreen, []);",!1,document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement),c("controls","Projector.checkboxClick(this, Projector.toggleData, [selector.controls, 'controls']);",!1,s.controls),c("keyboard","Projector.checkboxClick(this, Projector.toggleData, [selector.slides, 'keyboard']);",!0,s.keyboard),c("mousewheel","Projector.checkboxClick(this, Projector.toggleData, [selector.slides, 'mousewheel']);",!0,s.mouseWheel),c("cursor","Projector.checkboxClick(this, Projector.toggleData, [selector.upper_layer, 'nocursor']);",!0,s.cursorVisible),c("selection","Projector.checkboxClick(this, Projector.toggleData, [selector.upper_layer, 'selection']);",!0,s.selectionEnabled),c("progress","Projector.checkboxClick(this, Projector.toggleData, [selector.progress, 'progress']);",!1,s.progress),c("loop","Projector.checkboxClick(this, Projector.toggleData, [selector.slides, 'loop']);",!0,s.loop),c("resize","Projector.checkboxClick(this, Projector.toggleData, [selector.slides, 'resize']);Projector.slidesResize();",!0,s.resizeSlides),window.addEventListener("resize",i,!1),document.addEventListener("keydown",function(e){"F5"!==e.code&&"Escape"!==e.code&&"F11"!==e.code||e.preventDefault()},!1),document.addEventListener("keyup",function(e){"KeyP"===e.code?p(o.pause,"pause"):"Semicolon"===e.code?p(o.menu,"menu"):"KeyR"===e.code||("Escape"===e.code||"F5"===e.code||"F11"===e.code||"KeyF"===e.code?m(document.querySelector("#fullscreen div"),d,[]):("ArrowLeft"!==e.code&&"ArrowDown"!==e.code&&"Backspace"!==e.code||"false"!==o.pause.dataset.pause||"true"!==o.slides.dataset.keyboard)&&("ArrowRight"===e.code||"ArrowUp"===e.code||"Space"===e.code||"Enter"===e.code)&&"false"===o.pause.dataset.pause&&o.slides.dataset.keyboard)},!1),o.upperLayer.addEventListener("mouseup",function(e){(0===e.button||1===e.button)&&"false"===o.pause.dataset.pause&&o.upper_layer.dataset.selection},!1),document.addEventListener("wheel",function(e){"true"===o.slides.dataset.mousewheel&&"false"===o.pause.dataset.pause&&"false"===o.menu.dataset.menu&&(e.deltaY>0||e.deltaY)},!1),o.slides.style.width=s.widthSlide+"px",o.slides.style.height=s.heightSlide+"px",document.querySelectorAll("[data-trad]").forEach(function(e){e.innerHTML=r[document.documentElement.lang][e.dataset.trad]}),window.addEventListener("message",function(t){let o=t.data;"string"==typeof o&&"{"===o.charAt(0)&&"}"===o.charAt(o.length-1)&&(o=JSON.parse(o)).method&&"function"==typeof e[o.method]&&e[o.method].apply(e,o.args)},!1),setInterval(function(){0===o.body.scrollTop&&0===o.body.scrollLeft||(o.body.scrollTop=0,o.body.scrollLeft=0)},1e3),"auto"===s.cursorVisible?(document.addEventListener("mousemove",a,!1),document.addEventListener("mousedown",a,!1)):(o.upperLayer.dataset.cursor=s.cursorVisible,o.upperLayer.dataset.selection=s.selectionEnabled,document.removeEventListener("mousemove",a,!1),document.removeEventListener("mousedown",a,!1)),function(){let e=document.createElement("img");e.src="core-utils/media/logo_negative.png",e.style.position="absolute",e.style.bottom="20px",e.style.left="50%",e.style.marginLeft="-100px",e.style.width="200px",e.style.height="auto",o.end.appendChild(e)}(),s.autoplay?n.autoplayId=window.setInterval(u,s.autoplayTiming):(window.clearInterval(n.autoplayId),n.autoplayId=null),o.body.removeChild(o.loading),delete o.loading,n.started=!0)},resizeSlides:i,toggleFullscreen:d,toggleData:p,checkboxClick:m,settings:s,selector:o}});