/*
 * projector.js v1.0.0
 *
 * Copyright (C) 2019 Samuel Lager
 */

!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.Projector=t()}(this,function(){"use strict";let e,t="1.0.0",o={body:document.querySelector("body"),slides:document.querySelector(".slides")},n={autoplay:!1,autoplayTiming:4e3,animations:!0,controls:!0,cursorVisible:"auto",cursorVisibleTiming:4e3,defaultBackground:"none",defaultBackgroundOptions:{},defaultTransition:"none",defaultTransitionOptions:{},heightSlide:1080,history:!1,loop:!1,mouseWheel:!0,progress:!0,resizeSlides:!0,selectionEnabled:!0,speakerWindow:!1,widthSlide:1920},s={autoplayId:null,cursorVisibleTimingId:null,initialized:!1,loaded:!1,nbSlide:0,menu:!0,pause:!1,scale:1,selection:!1,slideActive:-1,userAgent:null},r={en:{pause:'<b>PAUSE</b><br>Press <span class="keybind_white">P</span> to continue',end:'<b>END</b><br>Press <span class="keybind_white">P</span> to restrart',stop_presenting:"STOP PRESENTING",options_title:"Options",fullscreen_option:"Fullscreen",fullscreen_option_info:"Shortcut : F"},fr:{pause:'<b>PAUSE</b><br>Presser <span class="keybind_white">P</span> pour continuer',end:'<b>END</b><br>Presser <span class="keybind_white">R</span> pour revoir',stop_presenting:"ARRÊTER LA PRÉSENTATION",options_title:"Options",fullscreen_option:"Plein écran",resize_option:"Adapter à l'écran",resize_option_info:"Adapte la taille de la diapositive à l'écran tout en conservant le ratio",loop_option:"Lire en boucle",loop_option_info:"Après la dernière diapositive reviens à la première",autoplay_option:"Lecture automatique",autoplay_option_info:"Passe à la diapositive suivante automatiquement",mousewheel_option:"Contrôler avec la molette",mousewheel_option_info:"Permet de contrôler le diaporama avec la molette de la souris",cursor_option:"Cacher le curseur",cursor_option_info:"Désactive le curseur de la souris",selection_option:"Autoriser la sélection",selection_option_info:"Désactive le clic gauche de la souris pour passer à la diapositive suivante",progress_option:"Barre de progression",controls_option:"Afficher les contrôles",shortcuts_title:"Raccourcis",shortcut_fullscreen:"<b>F</b> : Plein écran",shortcut_menu:"<b>M</b> : Menu",shortcut_previous:"<b>Flèche gauche/bas</b> : Diapositive précédente",shortcut_next:"<b>Espace</b>, <b>Flèche droite/haut</b>, <b>Clique gauche</b> : Dispositive suivante",shortcut_pause:"<b>P</b> : Pause",shortcut_restart:"<b>R</b> : Recommencer"}};function i(){"true"===o.slides.dataset.resize?(s.scale=Math.min(window.innerHeight/o.slides.dataset.height,window.innerWidth/o.slides.dataset.width),o.slides.style.transform="translate(-50%, -50%) scale("+s.scale+")"):(s.scale=1,o.slides.style.transform="translate(-50%, -50%)")}function l(e,t,n,s,r,i){let l=document.createElement(t);l.classList.add(n);for(let e in s)l.dataset[e]=s[e];return l.innerHTML=r,i?e.insertBefore(l,o.slides):e.appendChild(l),l}function a(e,t,n,s){let r='<div class="checkbox';s&&(r+=" checked"),r+='" id="'+e+'">    <div onclick="'+t+'"></div>    <span data-trad="'+e+'_option"></span></div>',n&&(r+='<p class="info" data-trad="'+e+'_option_info"></p>'),l(o.menu.children[1].children[0],"div","option",null,r,!1)}function c(){s.pause=!s.pause,o.pause.dataset.pause=(!_(o.pause.dataset.pause)).toString()}function u(){s.menu=!s.menu,o.menu.dataset.menu=(!_(o.menu.dataset.menu)).toString()}function d(){y(document.querySelector("#fullscreen")),p()?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen()}function p(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function m(){"auto"===n.cursorVisible?(document.addEventListener("mousemove",g,!1),document.addEventListener("mousedown",g,!1)):(o.upperLayer.dataset.cursor=n.cursorVisible,o.upperLayer.dataset.selection=n.selectionEnabled,document.removeEventListener("mousemove",g,!1),document.removeEventListener("mousedown",g,!1))}function g(){o.upperLayer.dataset.cursor="true",o.upperLayer.dataset.selection=n.selectionEnabled,clearTimeout(s.cursorVisibleTimingId),s.cursorVisibleTimingId=setTimeout(function(){o.upperLayer.dataset.cursor="false",o.upperLayer.dataset.selection="false"},n.cursorVisibleTiming)}function h(){n.autoplay?s.autoplayId=window.setInterval(b,n.autoplayTiming):(window.clearInterval(s.autoplayId),s.autoplayId=null)}function f(){}function b(){}function v(){}function y(e){e.classList.toggle("checked")}function _(e){if("string"==typeof e){if("null"===e)return null;if("true"===e)return!0;if("false"===e)return!1;if(e.match(/^-?\d*\.\d*$/))return parseFloat(e);if(e.match(/^-?\d*$/))return parseInt(e)}return e}return e={start:function(g){s.initialized||(s.initialized=!0,console.info("v"+t),function(e,t){for(let o in t)e[o]=t[o]}(n,g),s.userAgent=navigator.userAgent,s.nbSlide=o.slides.children.length,o.loading=l(o.body,"div","loading",null,'<div class="lds-ring"><div></div><div></div><div></div><div></div></div>',!0),o.end=l(o.body,"div","end",{end:!1},'<p data-trad="end"></p>',!0),o.backgrounds=l(o.body,"div","backgrounds",null,"",!0),o.upperLayer=l(o.body,"div","upper_layer",{cursor:n.cursorVisible&&"auto"!==n.cursorVisible,selection:n.selectionEnabled},"",!1),o.progress=l(o.body,"div","progress",{progress:n.progress},"",!1),o.controls=l(o.body,"div","controls",{controls:n.controls},'<img src="core-utils/media/projector_controls_icon.png" onclick="previousSlide()"><img src="core-utils/media/projector_controls_icon.png" onclick="nextSlide()">',!1),o.pause=l(o.body,"div","pause",{pause:s.pause},'<p data-trad="pause"></p>',!1),o.menu=l(o.body,"div","menu",{menu:s.menu},'<div class="top_logo">    <a href="https://www.impart.com"><img src="core-utils/media/logo_negative.png"></a></div><div class="content">    <div class="content_part">        <p class="title" data-trad="options_title"></p>    </div>    <div class="content_part">        <p class="title" data-trad="shortcuts_title"></p>        <p class="shortcut" data-trad="shortcut_fullscreen"></p>        <p class="shortcut" data-trad="shortcut_menu"></p>        <p class="shortcut" data-trad="shortcut_previous"></p>        <p class="shortcut" data-trad="shortcut_next"></p>        <p class="shortcut" data-trad="shortcut_pause"></p>        <p class="shortcut" data-trad="shortcut_restart"></p>    </div></div><div class="bottom_stop" onclick="window.close();">    <p data-trad="stop_presenting"></p></div>',!1),a("fullscreen","Projector.toggleFullscreen();",!1,p()),a("controls","Projector.toggleControls(this);",!1,n.controls),a("mousewheel","Projector.toggleMouseWheel(this);",!0,n.mouseWheel),a("cursor","Projector.toggleCursorVisible(this);",!0,n.cursorVisible),a("selection","Projector.toggleSelection(this);",!0,n.selectionEnabled),a("progress","Projector.toggleProgress(this);",!1,n.progress),a("loop","Projector.toggleLoop(this);",!0,n.loop),a("autoplay","Projector.toggleAutoplay(this);",!0,n.autoplay),a("resize","Projector.toggleResize(this);",!0,n.resizeSlides),window.addEventListener("resize",i,!1),document.addEventListener("keydown",function(e){"F5"!==e.code&&"Escape"!==e.code&&"F11"!==e.code||e.preventDefault()},!1),document.addEventListener("keyup",function(e){"KeyP"===e.code?c():"Semicolon"===e.code?u():"KeyR"===e.code||("Escape"===e.code||"F5"===e.code||"F11"===e.code||"KeyF"===e.code?d():("ArrowLeft"!==e.code&&"ArrowDown"!==e.code&&"Backspace"!==e.code||s.pause)&&("ArrowRight"===e.code||"ArrowUp"===e.code||"Space"===e.code||"Enter"===e.code)&&s.pause)},!1),o.upperLayer.addEventListener("mouseup",function(e){0!==e.button&&1!==e.button||s.pause||n.selectionEnabled},!1),document.addEventListener("wheel",function(e){!n.mouseWheel||s.pause||s.menu||e.deltaY>0||e.deltaY},!1),o.slides.style.width=n.widthSlide+"px",o.slides.style.height=n.heightSlide+"px",document.querySelectorAll("[data-trad]").forEach(function(e){e.innerHTML=r[document.documentElement.lang][e.dataset.trad]}),window.addEventListener("message",function(t){let o=t.data;"string"==typeof o&&"{"===o.charAt(0)&&"}"===o.charAt(o.length-1)&&(o=JSON.parse(o)).method&&"function"==typeof e[o.method]&&e[o.method].apply(e,o.args)},!1),setInterval(function(){0===o.body.scrollTop&&0===o.body.scrollLeft||(o.body.scrollTop=0,o.body.scrollLeft=0)},1e3),m(),function(){let e=document.createElement("img");e.src="core-utils/media/logo_negative.png",e.style.position="absolute",e.style.bottom="20px",e.style.left="50%",e.style.marginLeft="-100px",e.style.width="200px",e.style.height="auto",o.end.appendChild(e)}(),h(),o.body.removeChild(o.loading),delete o.loading,s.started=!0)},previousSlide:f,nextSlide:b,goSlide:v,toggleFullscreen:d,togglePause:c,toggleMenu:u,toggleControls:function(e){n.controls=!n.controls,o.controls.dataset.controls=(!_(o.controls.dataset.controls)).toString(),y(e.parentElement)},toggleMouseWheel:function(e){n.mouseWheel=!n.mouseWheel,y(e.parentElement)},toggleCursorVisible:function(e){n.cursorVisible=e,m()},toggleSelection:function(e){n.selectionEnabled=!n.selectionEnabled,o.upperLayer.dataset.selection=(!_(o.upperLayer.dataset.selection)).toString(),y(e.parentElement)},toggleProgress:function(e){n.progress=!n.progress,o.progress.dataset.progress=(!_(o.progress.dataset.progress)).toString(),y(e.parentElement)},toggleLoop:function(e){n.loop=!n.loop,y(e.parentElement)},toggleAutoplay:function(e){n.autoplay=!n.autoplay,y(e.parentElement),h()},toggleResize:function(e){n.resizeSlides=!n.resizeSlides,y(e.parentElement),i()},settings:n,selector:o}});